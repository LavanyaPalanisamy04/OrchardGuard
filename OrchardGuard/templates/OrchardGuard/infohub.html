
{% extends 'OrchardGuard/base.html' %}
{% load static %}
{% block extra_head %}
    <title>Disease Prediction</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-+0n0xVW2eSR5Zgb2q9WrMuuMSwUx6j7U3DBQk5rVjNExlSMXQz/i5XyJ2c5IQF5k" crossorigin="anonymous"></script>
    <link rel="stylesheet" href={% static 'OrchardGuard/infohub.css' %}>


{% endblock %}
{% block content %}
  <section id="header">
    <div class="header container">
      <div class="nav-bar">
        <div class="brand">
          <a href="#hero">
            <h1><span>O</span>RCHARD <span>G</span>UARD</h1>
          </a>
        </div>

        <div class="nav-list">
          <div class="hamburger">
            <div class="bar"></div>
          </div>
          <ul>
            <li><a href="{% url 'homepage' %}" >Home</a></li>
            <li><a href= "{% url 'homepage' %}">About Us</a></li>
            <li><a href="{% url 'homepage' %}">Contact us</a></li>
            <li><a href="{% url 'upload_and_predict' %}">Predict</a></li>
               <li><a href="{% url 'infohub' %}">Infohub</a></li>
             <li><a href="{% url 'logout' %}">Logout</a></li>
{#            <li><a href="vinsha_login.html" >Login</a></li>#}


                      </ul>
        </div>
      </div>
    </div>
  </section>


<!-- Rest of your content -->

{#<video autoplay muted loop class="bg-video">#}
{#    <source src="{% static 'OrchardGuard/videos/home.mp4' %}" type="video/mp4">#}
{#    Your browser does not support HTML5 video.#}
{#</video>#}

    <div class="container">
        <h2>Search Information</h2>
        <div class="content-container"> <!-- This is the new parent flex container -->
            <div class="forms-container">
        <div class="search-options">
            <div class="search-option" id="any-search-link">Any Search</div>
            <div class="search-option" id="search-link">Adv Search</div>
            <div class="search-option" id="list-search-link">List Search</div>
        </div>

        <div class="forms-container">
            <!-- Any Search Form -->
            <div id="any-search-form" class="form-container">
                <h2>Any Search Form</h2>
                <form method="post" action="{% url 'any_search' %}">
                    {% csrf_token %}
                    {{ any_search_form.as_p }}
                    <button type="submit">Search</button>
                </form>
            </div>

            <!-- Search Form -->
            <div id="search-form" class="form-container">
                <h2>Search Form</h2>
                <form method="post" action="{% url 'search' %}">
                    {% csrf_token %}
                    {{ search_form.as_p }}
                    <button type="submit">Search</button>
                </form>
            </div>

            <!-- List Search Form -->
            <div id="list-search-form" class="form-container">
                <h2>List Search Form</h2>
                <form method="post" action="{% url 'list_search' %}">
                    {% csrf_token %}
                    {{ list_search_form.as_p }}
                    <button type="submit">Search</button>
                </form>
            </div>
        </div>
            </div>
        <!-- Result Display -->
        <div class="results-container" id="search-results"></div>
    </div>
    </div>
</div>

    <script>
        // JavaScript to toggle form visibility

    // This function is used to hide all forms initially and show only the form related to the clicked link.
    function toggleFormVisibility(formIdToShow) {
        const forms = document.querySelectorAll('.form-container');
        forms.forEach(form => {
            form.style.display = 'none'; // Hide all forms by default
        });

        // Show the form that has the ID passed to the function
        const formToShow = document.getElementById(formIdToShow);
        if (formToShow) {
            formToShow.style.display = 'block';
        }
    }

    // This function sets up the event listeners for the search option links
    function setupSearchOptionLinks() {
        document.querySelectorAll('.search-option').forEach(option => {
            option.addEventListener('click', function() {
                // Extract the related form ID from the clicked link's ID
                const formIdToShow = option.id.replace('-link', '-form');
                toggleFormVisibility(formIdToShow);

                // Hide the results container
                document.getElementById('search-results').style.display = 'none';
            });
        });
    }

    // This function handles the form submission event
    function setupFormSubmissions() {
        document.querySelectorAll('.form-container form').forEach(form => {
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                const formData = new FormData(form);

                // Show a loading message or similar feedback to the user
                const resultsContainer = document.getElementById('search-results');
                resultsContainer.style.display = 'block';
                resultsContainer.innerHTML = '<p>Loading results...</p>';

                const xhr = new XMLHttpRequest();
                xhr.onload = function() {
                    if (xhr.status === 200) {
                        resultsContainer.innerHTML = xhr.responseText;
                    } else {
                        console.error('Request failed. Returned status of ' + xhr.status);
                        resultsContainer.innerHTML = '<p>Error loading results.</p>';
                    }
                };
                xhr.open('POST', form.action);

                // This line needs adjustment for actual CSRF token handling in a live environment
                // xhr.setRequestHeader('X-CSRFToken', '{{ csrf_token }}'); // Uncomment or modify in actual implementation

                xhr.send(formData);
            });
        });
    }

    // Run the setup functions when the window loads
    window.onload = function() {
        // Initially hide all forms
        toggleFormVisibility('any-search-form');
        // Setup the search option link event listeners
        setupSearchOptionLinks();
        // Setup the form submission event handlers
        setupFormSubmissions();
    };
</script>

{% endblock %}